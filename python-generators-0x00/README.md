# 🌀 Python Generators with PostgreSQL

## 📌 Objective

Implement a Python script that connects to a PostgreSQL database, creates a table, populates it with data from a CSV file, and lays the groundwork for streaming rows using a Python generator.

---

## 🚀 What This Project Does

- Connects to the PostgreSQL server
- Creates a database `ALX_prodev` if it doesn't exist
- Creates a `user_data` table with the following schema:
  - `user_id` (UUID, Primary Key, **auto-generated by PostgreSQL**)
  - `name` (VARCHAR)
  - `email` (VARCHAR)
  - `age` (DECIMAL)
- Loads sample data from a CSV file (`user_data.csv`)
- Inserts rows while avoiding duplicates
- Prints a few rows for verification

---

## 🛠️ Technologies Used

- Python 3.10+
- PostgreSQL
- psycopg2 (PostgreSQL driver for Python)
- python-dotenv (for managing environment variables)
- uuid-ossp PostgreSQL extension

---

## 📁 Project Structure

```
python-generators-0x00/
├── main.py             # Entry point to set up DB and load data
├── seed.py             # DB logic (connect, create, insert)
├── user_data.csv       # Sample user data to import
├── .env                # Environment config (not committed to Git)
└── README.md           # You're reading this
```

---

## 📦 Setup Instructions

### 1. ✅ Install Dependencies

```bash
pip install psycopg2-binary python-dotenv
```

### 2. ✅ PostgreSQL: Enable `uuid-ossp`

Connect to PostgreSQL and run:

```sql
CREATE EXTENSION IF NOT EXISTS "uuid-ossp";
```

This is needed to auto-generate UUIDs in the `user_id` column.

### 3. ✅ Create `.env` File

In the same folder as `main.py`, create a `.env` file:

```env
DB_HOST=localhost
DB_PORT=5432
DB_NAME=ALX_prodev
DB_USER=your_pg_user
DB_PASSWORD=your_pg_password
```

Replace values with your actual PostgreSQL credentials.

### 4. ✅ Prepare the CSV File

Make sure your `user_data.csv` contains:

```csv
"name","email","age"
"Johnnie Mayer","john@example.com","35"
"Jane Doe","jane@example.com","28"
```

No need to include `user_id` — it will be auto-generated by the database.

---

## ▶️ Run the Project

From inside the project folder:

```bash
cd python-generators-0x00
python3 main.py
```

You should see output like:

```
Database ALX_prodev already exists
Connection to default DB successful
Table user_data created successfully
Data inserted successfully.
Sample rows from user_data:
('12a6cf6a-9e1e-4a4f-b67b-7c09b33cb1a9', 'Johnnie Mayer', 'john@example.com', Decimal('35'))
...
```

---

## 🔄 Next Steps

The next part of this project involves building a **Python generator** to stream each row from the `user_data` table, one by one.

Example:

```python
def row_generator(connection):
    cursor = connection.cursor()
    cursor.execute("SELECT * FROM user_data")
    while True:
        row = cursor.fetchone()
        if row is None:
            break
        yield row
    cursor.close()
```

This makes your code memory-efficient and suitable for large datasets.

---

## ✅ Summary of What Was Done

- Used `psycopg2` to connect to PostgreSQL
- Used `.env` variables for database credentials
- Created database `ALX_prodev` if it didn't exist
- Created `user_data` table with UUID primary key (`uuid_generate_v4()`)
- Enabled PostgreSQL's `uuid-ossp` extension
- Loaded data from CSV (with no `user_id`)
- Auto-generated `user_id`s via database default
- Prepared for generator-based streaming

---

## 📚 References

- [PostgreSQL UUID Docs](https://www.postgresql.org/docs/current/datatype-uuid.html)
- [psycopg2 Documentation](https://www.psycopg.org/docs/)
- [python-dotenv Docs](https://pypi.org/project/python-dotenv/)
