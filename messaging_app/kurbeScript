#!/bin/bash

# kurbeScript: Set up and verify a local Kubernetes cluster using minikube

set -e

# Check if minikube is installed
if ! command -v minikube >/dev/null 2>&1; then
    echo "Minikube is not installed. Please install minikube first."
    exit 1
fi

# Check if kubectl is installed
if ! command -v kubectl >/dev/null 2>&1; then
    echo "kubectl is not installed. Please install kubectl first."
    exit 1
fi

# Start minikube cluster if not already running
if ! minikube status | grep -q "host: Running"; then
    echo "Starting minikube cluster..."
    minikube start
else
    echo "Minikube cluster is already running."
fi

# Verify cluster info
echo "Verifying Kubernetes cluster status..."
kubectl cluster-info

# Retrieve available pods in all namespaces
echo "Listing all pods in all namespaces:"
kubectl get pods --all-namespaces